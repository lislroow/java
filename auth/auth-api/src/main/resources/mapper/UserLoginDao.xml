<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spring.auth.common.login.dao.UserLoginDao">
  
  <select id="selectManagerByLoginId">
    SELECT /* UserLoginDao.selectManagerByLoginId */
           id,
           login_id,
           login_pwd,
           roles,
           mgr_name,
           enable_yn,
           locked_yn,
           pwd_exp_date
    FROM   au_manager
    <where>
       AND login_id = #{loginId}
    </where>
  </select>
  
  <select id="selectMemberByLoginId">
    SELECT /* UserLoginDao.selectMemberByLoginId */
           id,
           login_id,
           login_pwd,
           roles,
           realname,
           nickname,
           enable_yn,
           locked_yn,
           pwd_exp_date
    FROM   au_member
    WHERE  login_id = #{loginId}
  </select>
  
  <select id="selectMemberById">
    SELECT /* UserLoginDao.selectMemberById */
           id,
           login_id,
           login_pwd,
           roles,
           realname,
           nickname,
           enable_yn,
           locked_yn,
           pwd_exp_date
    FROM   au_member
    WHERE  id = #{id}
  </select>
  
  <select id="selectMemberIdByOauth2Id">
    SELECT /* UserLoginDao.selectMemberOauthByOauth2Id */
           id
    FROM   au_member_oauth
    <where>
       AND oauth2_id = #{oauth2Id}
    </where>
  </select>
  
  <insert id="insertMember">
    INSERT /* UserLoginDao.insertMember */
      INTO au_member (
      id,
      login_id,
      roles,
      nickname,
      enable_yn,
      locked_yn,
      pwd_exp_date,
      create_time,
      modify_time,
      create_id,
      modify_id
    ) VALUES (
      #{id},
      #{loginId},
      #{roles},
      #{nickname},
      #{enableYn},
      #{lockedYn},
      CURRENT_DATE,
      now(),
      now(),
      #{id},
      #{id}
    )
  </insert>
  
  <insert id="insertMemberOauth">
    INSERT /* UserLoginDao.insertMemberOauth */
      INTO au_member_oauth (
      id,
      oauth2_id,
      registration_id,
      email,
      nickname,
      create_time,
      modify_time,
      create_id,
      modify_id
    ) VALUES (
      #{id},
      #{oauth2Id},
      #{registrationId},
      #{email},
      #{nickname},
      now(),
      now(),
      #{id},
      #{id}
    )
  </insert>
  
</mapper>
