<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spring.auth.common.login.dao.UserLoginDao">
  
  <select id="selectManagerByLoginId">
    SELECT /* UserLoginDao.selectManagerByLoginId */
           A.id
           , A.login_id
           , A.login_pwd
           , A.roles
           , A.mgr_name
           , A.enable_yn
           , A.locked_yn
           , A.pwd_exp_date
    FROM   au_manager A
    <where>
       AND A.login_id = #{loginId}
    </where>
  </select>
  
  <select id="selectMemberByLoginId">
    SELECT /* UserLoginDao.selectMemberByLoginId */
           A.id
           , A.login_id
           , A.login_pwd
           , A.roles
           , A.realname
           , A.nickname
           , A.enable_yn
           , A.locked_yn
           , A.pwd_exp_date
    FROM   au_member A
    WHERE  A.login_id = #{loginId}
  </select>
  
  <select id="selectMemberById">
    SELECT /* UserLoginDao.selectMemberById */
           A.id
           , A.login_id
           , A.login_pwd
           , A.roles
           , A.realname
           , A.nickname
           , A.enable_yn
           , A.locked_yn
           , A.pwd_exp_date
    FROM   au_member A
    WHERE  A.id = #{id}
  </select>
  
  <select id="selectMemberIdByOauth2Id">
    SELECT /* UserLoginDao.selectMemberOauthByOauth2Id */
           A.id
    FROM   au_member_oauth A
    <where>
       AND A.oauth2_id = #{oauth2Id}
    </where>
  </select>
  
  <insert id="insertMember">
    INSERT /* UserLoginDao.insertMember */
      INTO au_member (
        id
        , login_id
        , roles
        , nickname
        , enable_yn
        , locked_yn
        , pwd_exp_date
        , create_time
        , modify_time
        , create_id
        , modify_id
      ) VALUES (
        #{id}
        , #{loginId}
        , #{roles}
        , #{nickname}
        , #{enableYn}
        , #{lockedYn}
        , CURRENT_DATE
        , now()
        , now()
        , #{id}
        , #{id}
      )
  </insert>
  
  <insert id="insertMemberOauth">
    INSERT /* UserLoginDao.insertMemberOauth */
      INTO au_member_oauth (
        id
        , oauth2_id
        , registration_id
        , email
        , nickname
        , create_time
        , modify_time
        , create_id
        , modify_id
      ) VALUES (
        #{id}
        , #{oauth2Id}
        , #{registrationId}
        , #{email}
        , #{nickname}
        , now()
        , now()
        , #{id}
        , #{id}
      )
  </insert>
  
</mapper>
