<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spring.auth.api.dao.TokenMngDao">
  
  <select id="searchTokens" resultType="TokenMngVo">
    SELECT /* TokenMngDao.searchTokens */
           A.token_id
           , A.client_id
           , A.enable_yn
           , A.locked_yn
           , A.create_id
           , A.create_time
           , (SELECT mgr_name FROM au_manager WHERE id = A.create_id) AS create_name
           , A.modify_id
           , A.modify_time
           , (SELECT mgr_name FROM au_manager WHERE id = A.modify_id) AS modify_name
    FROM   au_client_token A
    <where>
      <if test="tokenId != null and !''.equals(tokenId)">
        AND UPPER(A.token_id) LIKE UPPER(#{tokenId}) || '%'
      </if>
      <if test="clientId != null and !''.equals(clientId)">
        AND UPPER(A.client_id) LIKE UPPER(#{clientId}) || '%'
      </if>
      <if test="enableYn != null and !''.equals(enableYn)">
        AND A.enable_yn = #{enableYn}
      </if>
      <if test="lockedYn != null and !''.equals(lockedYn)">
        AND A.locked_yn = #{lockedYn}
      </if>
    </where>
    ORDER BY A.create_time DESC
  </select>
  
</mapper>
